<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - Community Portable Buildings</title>
    <link rel="stylesheet" href="admin-styles.css">
</head>
<body>
    <header class="admin-header">
        <div class="container">
            <h1>Admin Panel</h1>
            <div class="header-actions">
                <a href="index.html" target="_blank" class="btn btn-secondary">View Site</a>
            </div>
        </div>
    </header>

    <main class="container">
        <div class="admin-tabs">
            <button class="tab-btn active" data-tab="customization">Site Customization</button>
            <button class="tab-btn" data-tab="settings">Display Settings</button>
            <button class="tab-btn" data-tab="lots">Other Lots</button>
            <button class="tab-btn" data-tab="buildings">Manage Buildings</button>
        </div>

        <!-- Site Customization Tab -->
        <div class="tab-content active" id="customization-tab">
            <div class="card">
                <h2>Business Information</h2>

                <div class="form-group">
                    <label for="businessName">Business Name</label>
                    <input type="text" id="businessName" class="form-control"
                           placeholder="e.g., Community Portable Buildings">
                    <p class="help-text">This appears in the header of your website</p>
                </div>

                <div class="form-group">
                    <label for="businessPhone">Phone Number</label>
                    <input type="tel" id="businessPhone" class="form-control"
                           placeholder="e.g., 318-594-5909">
                    <p class="help-text">Main contact phone number for your business</p>
                </div>

                <div class="form-group">
                    <label for="businessEmail">Email Address</label>
                    <input type="email" id="businessEmail" class="form-control"
                           placeholder="e.g., info@yourcompany.com">
                    <p class="help-text">Business email for customer inquiries</p>
                </div>

                <div class="form-group">
                    <label for="businessAddress">Physical Address</label>
                    <textarea id="businessAddress" class="form-control" rows="2"
                              placeholder="e.g., 123 Main St, West Monroe, LA 71291"></textarea>
                    <p class="help-text">Your business location (optional)</p>
                </div>

                <div class="form-group">
                    <label for="facebookUrl">Facebook Page URL</label>
                    <input type="url" id="facebookUrl" class="form-control"
                           placeholder="e.g., https://facebook.com/yourpage">
                    <p class="help-text">Link to your business Facebook page</p>
                </div>

                <div class="form-group">
                    <label for="instagramUrl">Instagram Profile URL</label>
                    <input type="url" id="instagramUrl" class="form-control"
                           placeholder="e.g., https://instagram.com/yourprofile">
                    <p class="help-text">Link to your business Instagram profile</p>
                </div>

                <div class="form-group">
                    <label for="twitterUrl">Twitter/X Profile URL</label>
                    <input type="url" id="twitterUrl" class="form-control"
                           placeholder="e.g., https://twitter.com/yourprofile">
                    <p class="help-text">Link to your business Twitter/X profile (optional)</p>
                </div>
            </div>

            <div class="card">
                <h2>Facebook Auto-Posting</h2>
                <p class="help-text">Automatically post new building listings to your Facebook page
                    <a href="facebook-setup.html" target="_blank" style="margin-left: 0.5rem; color: #2196f3; text-decoration: none; font-weight: 600;">üìñ Setup Instructions ‚Üí</a>
                </p>

                <div class="setting-group">
                    <label class="toggle-label">
                        <input type="checkbox" id="enableAutoPost">
                        <span class="toggle-slider"></span>
                        <span class="toggle-text">Enable Auto-Posting to Facebook</span>
                    </label>
                </div>

                <div class="form-group" style="margin-top: 1.5rem;">
                    <label for="facebookPageId">Facebook Page ID
                        <a href="facebook-setup.html#step-5-find-your-facebook-page-id" target="_blank" style="margin-left: 0.5rem; font-size: 0.875rem; color: #2196f3; text-decoration: none;">How to find?</a>
                    </label>
                    <input type="text" id="facebookPageId" class="form-control"
                           placeholder="e.g., 123456789012345">
                    <p class="help-text">Your Facebook Page ID (found in page settings)</p>
                </div>

                <div class="form-group">
                    <label for="facebookAccessToken">Facebook Page Access Token
                        <a href="facebook-setup.html#step-4-get-your-page-access-token" target="_blank" style="margin-left: 0.5rem; font-size: 0.875rem; color: #2196f3; text-decoration: none;">How to get?</a>
                    </label>
                    <input type="password" id="facebookAccessToken" class="form-control"
                           placeholder="Enter your Facebook Page Access Token">
                    <p class="help-text">Long-lived page access token from Facebook Developer Console</p>
                </div>

                <div class="form-group">
                    <label>Auto-Post Conditions</label>
                    <div style="margin-top: 0.5rem;">
                        <label class="toggle-label" style="margin-bottom: 0.75rem;">
                            <input type="checkbox" id="autoPostNewOnly" checked>
                            <span class="toggle-slider"></span>
                            <span class="toggle-text">Only post new inventory (not repos)</span>
                        </label>
                    </div>
                    <div>
                        <label class="toggle-label" style="margin-bottom: 0.75rem;">
                            <input type="checkbox" id="autoPostWithImages" checked>
                            <span class="toggle-slider"></span>
                            <span class="toggle-text">Only post buildings with uploaded images</span>
                        </label>
                    </div>
                    <div>
                        <label class="toggle-label">
                            <input type="checkbox" id="autoPostAvailableOnly" checked>
                            <span class="toggle-slider"></span>
                            <span class="toggle-text">Only post available buildings (not sold/pending)</span>
                        </label>
                    </div>
                </div>

                <div class="form-group">
                    <label for="autoPostTemplate">Post Template</label>
                    <textarea id="autoPostTemplate" class="form-control" rows="6"
                              placeholder="Use {{name}}, {{size}}, {{price}}, {{type}} as placeholders">üè† New Arrival! {{name}}

üìê Size: {{size}}
üí∞ Cash Price: {{price}}
üìç Location: {{location}}

Call us at {{phone}} or visit our website to learn more!

#PortableBuildings #{{type}} #ForSale</textarea>
                    <p class="help-text">Customize the post message. Available placeholders: {{name}}, {{size}}, {{price}}, {{type}}, {{location}}, {{phone}}</p>
                </div>
            </div>

            <div class="card">
                <h2>Color Scheme</h2>
                <p class="help-text">Choose a professional 2-color gradient scheme</p>

                <div class="color-schemes">
                    <label class="color-scheme-option">
                        <input type="radio" name="colorScheme" value="rustic-earth" checked>
                        <div class="scheme-preview">
                            <div class="scheme-header">
                                <div class="scheme-gradient" style="background: linear-gradient(135deg, #2C5F2D 0%, #5D4E37 100%);"></div>
                            </div>
                            <div class="scheme-info">
                                <h3>Rustic Earth</h3>
                                <p>Forest green to earth brown - natural & professional</p>
                                <div class="scheme-colors">
                                    <span class="color-dot" style="background: #2C5F2D;" title="Forest Green"></span>
                                    <span class="color-dot" style="background: #5D4E37;" title="Earth Brown"></span>
                                </div>
                            </div>
                        </div>
                    </label>

                    <label class="color-scheme-option">
                        <input type="radio" name="colorScheme" value="modern-ranch">
                        <div class="scheme-preview">
                            <div class="scheme-header">
                                <div class="scheme-gradient" style="background: linear-gradient(135deg, #7C2529 0%, #3A3A3C 100%);"></div>
                            </div>
                            <div class="scheme-info">
                                <h3>Modern Ranch</h3>
                                <p>Barn red to charcoal - bold & confident</p>
                                <div class="scheme-colors">
                                    <span class="color-dot" style="background: #7C2529;" title="Barn Red"></span>
                                    <span class="color-dot" style="background: #3A3A3C;" title="Charcoal"></span>
                                </div>
                            </div>
                        </div>
                    </label>

                    <label class="color-scheme-option">
                        <input type="radio" name="colorScheme" value="desert-timber">
                        <div class="scheme-preview">
                            <div class="scheme-header">
                                <div class="scheme-gradient" style="background: linear-gradient(135deg, #C19A6B 0%, #8B7355 100%);"></div>
                            </div>
                            <div class="scheme-info">
                                <h3>Desert Timber</h3>
                                <p>Warm sand to rich wood - inviting & warm</p>
                                <div class="scheme-colors">
                                    <span class="color-dot" style="background: #C19A6B;" title="Desert Sand"></span>
                                    <span class="color-dot" style="background: #8B7355;" title="Rich Wood"></span>
                                </div>
                            </div>
                        </div>
                    </label>
                </div>

                <div class="form-group" style="margin-top: 2rem;">
                    <label for="buttonColor">Custom Button Color (Optional)</label>
                    <div style="display: flex; gap: 1rem; align-items: center;">
                        <input type="color" id="buttonColor" class="color-picker" value="#2C5F2D">
                        <input type="text" id="buttonColorHex" class="form-control" placeholder="#2C5F2D" style="max-width: 150px;">
                        <button class="btn btn-secondary btn-sm" onclick="resetButtonColor()">Reset</button>
                    </div>
                    <p class="help-text">Customize the button color on product cards (overrides scheme default)</p>
                </div>
            </div>

            <div class="card">
                <h2>Welcome Message</h2>

                <div class="form-group">
                    <label for="welcomeTitle">Title</label>
                    <input type="text" id="welcomeTitle" class="form-control"
                           value="Welcome to Community Portable Buildings of West Monroe, LA and Columbia, LA">
                </div>

                <div class="form-group">
                    <label for="welcomeMessage">Message</label>
                    <textarea id="welcomeMessage" class="form-control" rows="3">Take a look at what we have in stock, and let us know if we can design you a custom Graceland Building or help in any way!</textarea>
                </div>
            </div>

            <div class="card">
                <h2>Hero Carousel Images</h2>
                <p class="help-text">Current images in the carousel. Drag to reorder, click X to remove.</p>

                <div id="carousel-images" class="carousel-manager">
                    <!-- Will be populated by JavaScript -->
                </div>

                <div class="form-group">
                    <label for="newCarouselImage">Add New Image (filename from root directory)</label>
                    <div class="input-group">
                        <input type="text" id="newCarouselImage" class="form-control"
                               placeholder="e.g., Cabin-12x24-Angle.jpg">
                        <button class="btn btn-secondary" onclick="addCarouselImage()">Add Image</button>
                    </div>
                </div>
            </div>

            <button class="btn btn-primary btn-lg" onclick="saveCustomization()">üíæ Save All Customization</button>
        </div>

        <!-- Display Settings Tab -->
        <div class="tab-content" id="settings-tab">
            <div class="card">
                <h2>Display Settings</h2>

                <div class="setting-group">
                    <label class="toggle-label">
                        <input type="checkbox" id="showCashPrice" checked>
                        <span class="toggle-slider"></span>
                        <span class="toggle-text">Show Cash Prices</span>
                    </label>
                </div>

                <div class="setting-group">
                    <label class="toggle-label">
                        <input type="checkbox" id="showRtoOptions" checked>
                        <span class="toggle-slider"></span>
                        <span class="toggle-text">Show Rent-to-Own Options</span>
                    </label>
                </div>

                <button class="btn btn-primary" onclick="saveSettings()">Save Settings</button>
            </div>
        </div>

        <!-- Other Lots Tab -->
        <div class="tab-content" id="lots-tab">
            <div class="card">
                <h2>Manage Other Lot Locations</h2>
                <p class="help-text">Track inventory from other lot locations. Buildings will be tagged with their lot location.</p>

                <div id="lots-list" class="lots-list">
                    <!-- Will be populated by JavaScript -->
                </div>

                <div class="card" style="background: var(--background); margin-top: 1.5rem;">
                    <h3>Sync Inventory</h3>
                    <p class="help-text">‚úÖ Automatic sync runs daily at 2 AM. Or trigger a manual sync now:</p>
                    <button class="btn btn-primary" onclick="triggerManualSync()" id="manual-sync-btn">
                        üîÑ Run Manual Sync Now
                    </button>
                    <p id="sync-status" class="help-text" style="margin-top: 1rem; color: var(--text-light);"></p>
                </div>

                <div class="card" style="background: var(--background); margin-top: 1.5rem;">
                    <h3>Add New Lot Location</h3>
                    <p class="help-text">Enter GPB Sales credentials for another lot location. Buildings will be automatically synced daily and tagged with the lot name.</p>
                    <div class="form-group">
                        <label for="lot-name">Lot Name/Location</label>
                        <input type="text" id="lot-name" class="form-control" placeholder="e.g., Columbia, LA">
                    </div>
                    <div class="form-group">
                        <label for="lot-username">GPB Sales Username/Email</label>
                        <input type="email" id="lot-username" class="form-control" placeholder="Enter GPB Sales email">
                    </div>
                    <div class="form-group">
                        <label for="lot-password">GPB Sales Password</label>
                        <input type="password" id="lot-password" class="form-control" placeholder="Enter GPB Sales password">
                    </div>
                    <button class="btn btn-primary" onclick="addLot()">Add Lot Location</button>
                </div>
            </div>
        </div>

        <!-- Buildings Tab -->
        <div class="tab-content" id="buildings-tab">
            <div class="card">
                <h2>Manage Buildings</h2>

                <div class="admin-filters">
                    <div class="admin-filter-group">
                        <input type="text" id="building-search" class="form-control" placeholder="Search by serial number, size, or type...">
                    </div>
                    <div class="admin-filter-group">
                        <select id="building-status-filter" class="form-control">
                            <option value="all">All Buildings</option>
                            <option value="available">Available</option>
                            <option value="pending">Pending</option>
                            <option value="sold">Sold</option>
                            <option value="hidden">Hidden</option>
                        </select>
                        <select id="building-type-filter" class="form-control">
                            <option value="all">All Types</option>
                            <option value="new">New Inventory</option>
                            <option value="repo">Pre-Owned (Repo)</option>
                        </select>
                    </div>
                </div>

                <div class="buildings-list" id="buildings-list">
                    <!-- Will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </main>

    <div class="toast" id="toast">
        <span id="toast-message"></span>
    </div>

    <!-- Image Upload Modal -->
    <div class="modal" id="image-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Manage Building Images</h2>
                <button class="modal-close" onclick="closeImageModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div id="modal-building-info"></div>

                <div class="image-gallery" id="building-images">
                    <!-- Uploaded images will appear here -->
                </div>

                <div class="upload-section">
                    <label class="upload-btn">
                        <input type="file" id="image-upload" accept="image/*,.heic" multiple style="display: none;">
                        <span>üì∑ Upload Photos (Max 5)</span>
                    </label>
                    <p class="help-text">Supports JPG, PNG, HEIC. HEIC will be auto-converted. Drag images to reorder. Click ‚òÖ to set main image.</p>
                </div>

                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="closeImageModal()">Close</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/heic2any@0.0.4/dist/heic2any.min.js"></script>
    <script src="decoder.js"></script>
    <script src="inventory.js"></script>
    <script src="admin.js"></script>
</body>
</html>
